# Система мониторинга веб-приложения

## Описание
Автоматизированная система мониторинга и восстановления веб-приложения с использованием Go, systemd и Ansible. Система обеспечивает постоянную доступность веб-сервиса с автоматическим перезапуском при сбоях.

## Архитектура решения

### Компоненты системы:
- web-monitoring.go - Веб-приложение на Go, возвращающее "Hello World!"
- health-check.sh - Скрипт проверки здоровья приложения
- systemd сервисы - Для автоматического управления и мониторинга
- Ansible плейбук - Для автоматического развертывания и обновления

### Структура проекта:
project/
├── deploy.yml - Ansible плейбук для развертывания
├── vars.yml - Конфигурационные переменные
├── README.md - Документация
└── files/ - Исходные файлы приложения
    ├── web-monitoring.go - Исходный код приложения
    ├── health-check.sh - Скрипт мониторинга
    ├── templates/ - Шаблоны конфигураций
    │   ├── web-monitoring.service.j2
    │   ├── health-check.service.j2
    │   └── health-check.timer.j2
    └── systemd/ - Исходные systemd файлы
        ├── web-monitoring.service
        ├── health-check.service
        └── health-check.timer

## Функциональность

### Основные возможности:
- Веб-приложение - Сервер на Go, возвращающий "Hello World!" на порту 8080
- Мониторинг здоровья - Автоматическая проверка доступности каждые 30 секунд
- Авто-восстановление - Перезапуск приложения при обнаружении сбоя
- Логирование - Запись всех событий мониторинга в файл логов
- Автозапуск - Запуск при загрузке системы и поддержание работы

### Systemd сервисы:
- web-monitoring.service - Основной сервис приложения
- health-check.service - Сервис проверки здоровья
- health-check.timer - Таймер периодического запуска проверок

## Быстрый запуск

### 1. Установка и запуск:
# Клонирование репозитория
git clone <repository-url>
cd <project-directory>

# Запуск автоматического развертывания
ansible-playbook deploy.yml

### 2. Проверка работы:
# Проверить статус приложения
systemctl status web-monitoring

# Проверить статус мониторинга
systemctl status health-check.timer

# Просмотр логов мониторинга
tail -f /var/log/service-health.log

# Просмотр логов приложения
journalctl -u web-monitoring -f

### 3. Тестирование работы:
# Проверить ответ приложения
curl http://localhost:8080
# Должен вернуть: Hello World!

## Конфигурация

Все настройки системы находятся в файле vars.yml:

### Основные параметры:
app_config:
  name: "web-monitoring"    # Имя сервиса
  port: "8080"             # Порт приложения
  host: "localhost"        # Хост приложения

health_check:
  interval: "30s"          # Интервал проверки здоровья
  boot_delay: "1min"       # Задержка после загрузки системы
  timeout: 5               # Таймаут HTTP запроса

paths:
  app_dir: "/home/mikhail/web-monitoring"  # Директория приложения
  log_file: "/var/log/service-health.log"  # Файл логов мониторинга

app_user: "mikhail"        # Пользователь для запуска приложения

## Логирование

### Файлы логов:
- Логи мониторинга: /var/log/service-health.log
- Логи приложения: journalctl -u web-monitoring
